{
    "contents" : "##############################################################################\n# Analysis of per site results from SEQC from a given analysis pipeline\n##############################################################################\n# Get required libraries\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(scales)\nlibrary(edgeR)\nlibrary(locfit)\nlibrary(QuasiSeq)\nlibrary(grid)\n\n# Source package scripts\nsource(\"R/initDat.R\") # combine technical replicates\nsource(\"R/sumTechReps.R\") # combine technical replicates\nsource(\"R/getDesignMat.R\") # build factor matrix from sample names\nsource(\"R/dynRangePlot.R\") # dose response curve for dynamic range\nsource(\"R/dynRangePlotLODR.R\") # plot dyn Range with LODR\nsource(\"R/estLODR.R\") # estimate LODR\nsource(\"R/est_r_m.R\") # estimate r_m\nsource(\"R/loadERCCInfo.R\") # load ERCC definition files\nsource(\"R/loadExpMeasFromRaw.R\") # load expression measures from file\nsource(\"R/maConcPlot.R\") # MA plot coded with LODR\nsource(\"R/multiplot.R\") # plot multiple plots on the same page\nsource(\"R/printLODRres.R\") # print LODR results table\nsource(\"R/QL.results.R\")# load the updated QL.results function for QuasiSeq \nsource(\"R/erccROC.R\") # ROC Plot\nsource(\"R/testDE.R\") # test for DE, obtain p and q values\nsource(\"R/dashboardPDF.R\") #\nsource(\"R/prepERCCDat.R\") #\nsource(\"R/libeSizeNorm.R\")\nsource(\"R/estMnLibeFactor.R\")\nsource(\"R/meltedExpDat.R\")\nsource(\"R/geneExprTest.R\")\nsource(\"R/printLODRres.R\")\nsource(\"R/saveInputs.R\")\nsource(\"R/saveResults.R\")\n\n\n###############################################################################\n# Initialize expDat list\n###############################################################################\n# Input parameter adjustments\n# For platform = \"ILM\" use analysis = \"NCTR\", siteName may be equal to \n# \"MAY\",\"BGI\",\"CNL\",\"NVS\",\"AGR\",or \"COH\"\n# For platform = \"LIF\" use analysis = \"NIST\", siteName may be equal to\n# \"SQW\",\"NWU\",or \"PSU\"\n# ERCC dilution = the dilution of the Ambion ERCC mixes prior to spiking, if no \n# dilution was performed then ERCCdilution = 1\n# spikeVol = the amount of diluted ERCC mix spiked into the total RNA sample, \n# units are in microliters\n# totalRNAmass = mass of total RNA spiked with the diluted ERCC mix, \n# units are in micrograms\n###############################################################################\nexpDat <- initDat(study = \"SEQC_Main\", siteName = \"Lab9\", platform = \"LIF\",\n                  analysis = \"NIST\", sample1Name = \"UHRR\", sample2Name = \"HBRR\",\n                  choseFDR = 0.01, ERCCdilution = 1, spikeVol = 50, \n                  totalRNAmass = 2.5*10^(3), printPDF = F, DEtest = F,\n                  totalSeqReads = T, libeSizeNorm = T, myYLimMA = c(-3.5,3.5),\n                  myXLim = c(-10,15),myYLim = NULL)\n\n###############################################################################\n# Run loadERCCInfo function to obtain ERCC information\nexpDat <- loadERCCInfo(expDat, erccMixes=\"Ambion4plexPair\")\n\n###############################################################################\n# Run loadExpMeas function to process count data file\nexpDat <- loadExpMeasFromRaw(expDat)\n\n### To Do Sarah Munro set this up so that we can provide the smallest possible\n### set of data to users \n\n###############################################################################\n# library size normalize the data\nexpDat <- libeSizeNorm(expDat)\n\n###############################################################################\n# length normalize the ERCC concentrations\nexpDat <- prepERCCDat(expDat)\n\n###############################################################################\n# Revert to raw counts to sum fluidic replicates, exclude Library 5\nexpDat = sumTechReps(expDat,libeList = levels(expDat$designMatAB$Library)[-5])\n\n###############################################################################\n### Save input data, only use for SEQC data prep \nsaveInputs(expDat)",
    "created" : 1387217499593.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1110357932",
    "id" : "2613A424",
    "lastKnownWriteTime" : 1383589563,
    "path" : "~/Documents/NISTMunro/Projects/erccdashboard/dashboardScripts/prepSEQCMainData.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}