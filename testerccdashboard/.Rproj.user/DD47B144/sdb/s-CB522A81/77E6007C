{
    "contents" : "%\\VignetteIndexEntry{testerccdashboard examples}\n\n\\documentclass{article}\n\\usepackage{fullpage}\n\\begin{document}\n\\SweaveOpts{concordance=TRUE}\n\\SweaveOpts{keep.source=TRUE}\n\\SweaveOpts{width=7, height=7}\n\\DefineVerbatimEnvironment{Sinput}{Verbatim} {xleftmargin=1em}\n\\DefineVerbatimEnvironment{Soutput}{Verbatim}{xleftmargin=1em}\n\\DefineVerbatimEnvironment{Scode}{Verbatim}{xleftmargin=1em}\n\\fvset{listparameters={\\setlength{\\topsep}{0pt}}}\n\\renewenvironment{Schunk}{\\vspace{\\topsep}}{\\vspace{\\topsep}}\n<<echo=false>>=\noptions(width=60, continue = \"  \")\n#options(SweaveHooks=list(fig=function()\n#                par(mar=c(5.1,4.1,1.1,2.1))))\n@\n    \n\\title{{\\tt testerccdashboard} Package Example}\n\\author{Sarah A. Munro}\n\\maketitle\n\n\\begin{center}\n\\Large\n{\\tt erccdashboard} Package Vignette\n\\normalsize\n\\end{center}\nThis vignette describes the use of the erccdashboard R package to analyze \nExternal RNA Control Consortium (ERCC) spike-in control ratio mixtures in gene\nexpression experiments. Two types of data from the SEQC/MAQC III project were analyzed.\n\\begin{enumerate}\n  \\item Rat toxicogenomics treatment and control samples for different drug \n  treatments\n  \\item Human reference RNA samples from the MAQC I project, Universal Human \n  Reference RNA (UHRR) and Human Brain Reference RNA (HBRR)\n\\end{enumerate}\n\n\\section{Rat Toxicogenomics Example: MET treatment}\n\\subsection{Define input data and parameters}\n\nLoad the testerccdashboard package. \n<<initializeData,results=hide,echo=TRUE>>=\nlibrary( \"testerccdashboard\" )\n@\nLoad the Rat Toxicogenomics Data set.\n<<loadRatData>>=\nload(file = system.file(\"data/SEQC.RatTox.Example.RData\", \n                        package = \"testerccdashboard\"))\n@\nThe R workspace should now contain 5 count tables and for each count table a \ncorresponding total reads vector.\nTake a look at the data for the MET experiment.\n<<inspectRatData,keep.source=T>>=\nhead(COH.RatTox.ILM.MET.CTL.countTable)\nCOH.RatTox.ILM.MET.CTL.totalReads\n@\nThe first column of the count table, Feature, contains unique names for all\nthe transcripts that were quantified in this experiment. The remaining columns\nrepresent replicates of the pair of samples, in this count table \nthe control sample is labeled CTL and the treatment sample is labeled MET. An underscore is included to separate the sample names from the replicate numbers during analysis. This naming convention Sample\\textunderscore{}Rep is needed for the columns of any input count table.\n\nThe total reads vectors will be used for library size normalization of the count\ntables. Total reads can either represent the total number of reads in FASTQ \nfiles or total mapped reads. In the examples provided with this package FASTQ \nfile total reads are used.\n\nFor our analysis of the MET-CTL experiment start by assigning the MET-CTL data to the input data variables countTable and totalReads.\n<<defineInputData,keep.source=T>>=\ncountTable <- COH.RatTox.ILM.MET.CTL.countTable\ntotalReads <- COH.RatTox.ILM.MET.CTL.totalReads\n@\nIn addition to countTable and totalReads, there are 7 additional variables that must be defined by the user. First the filename prefix for results files, filenameRoot, needs to be defined. Here we choose to use the lab abbreviation COH and the platform abbreviation ILM as our identifiers, but this is flexible for the user.\n<<definefileRoot,keep.source=T>>=\nfilenameRoot = \"COH.ILM\"\n@\nNext, 5 parameters associated with the ERCC control ratio mixtures need to be defined, sample1Name, sample2Name, ERCCdilution, spikeVol, and totalRNAmass.\n\nThe sample spiked with ERCC Mix 1 is sample1Name and the sample spiked with ERCC Mix 2 is sample2Name. In this experiment sample1Name = MET and sample2Name = CTL. For a more robust experimental design the reverse spike-in design could also be produced using additional replicates of the treatment and control samples. ERCC Mix 2 would be spiked into MET samples and ERCC Mix 1 would be spiked into CTL control replicates. \n\nThe dilution factor of the pure Ambion ERCC mixes prior to spiking is ERCCdilution. If no dilution was performed then ERCCdilution should be 1. The amount of diluted ERCC mix spiked into the total RNA sample is spikeVol (units are $\\mu$L). The mass of total RNA spiked with the diluted ERCC mix is totalRNAmass (units are $\\mu$g )\n<<defineInputSpikes,keep.source=T>>=\nsample1Name = \"MET\"\nsample2Name = \"CTL\"\nERCCdilution = 1/100\nspikeVol = 1\ntotalRNAmass = 0.500\n@\nThe final required input parameter, choseFDR, is the False Discovery Rate (FDR) for differential expression testing. A typical choice would be 0.05 (5\\% FDR), for the rat data a more liberal FDR was used, choseFDR = 0.1.\n<<defineFDR,keep.source=T>>=\nchoseFDR = 0.1\n@\nIn addition to the required input variables the user can also choose whether to print the results directly to a PDF file (the default is TRUE) with the variable printPDF.\n\\subsection{Use initDat function to create expDat}\nThe expDat list is created with the initDat function:\n<<initializeData,keep.source=T>>=\nexpDat <- initDat(countTable, totalReads, filenameRoot, sample1Name,\n                  sample2Name, ERCCdilution, spikeVol, totalRNAmass, choseFDR,\n                  printPDF = F)\n@\nLook at the structure of expDat\n<<initializeData,keep.source=T>>=\nsummary(expDat)\n@\nEstimate r$_m$ for the sample pair using a negative binomial glm\n\\begin{center}\n<<est_r_m, fig=TRUE >>=\nexpDat <- est_r_m(expDat, cnt = expDat$Transcripts, printPlot = T)\n@\n\\end{center}\nTest for differential expression with geneExprTest\n<<geneExprTest, fig=T>>=\nexpDat <- geneExprTest(expDat, cnt = expDat$Transcripts,\n                       designMat = expDat$designMat )\n@\nGenerate ROC curves for the selected differential ratios\n<<erccROC, fig=T>>=\nerccROC.res = erccROC(expDat)\n@\nFind LODR estimates using the ERCC data p-values.\n<<estLODRERCC, fig=T>>=\nlodr.ERCC = estLODR(expDat,kind = \"ERCC\", prob=0.9)\n@\nOne can also obtain LODR estimates using p-values simulated from endogenous transcripts\n<<estLODRSim, fig=T>>=\nlodr.Sim = estLODR(expDat, kind = \"Sim\", prob = 0.9)  \n@\n\\subsection{Use dynRangePlot function to evaluate dynamic range data}\nEvaluate the dynamic range of the experiment using the ERCC controls.\n\\begin{center}\n<<dynRangeDat,fig=TRUE>>=\ndynRangeDat = dynRangePlot(expDat, expressDat = expDat$expressDat,\n                           designMat = expDat$designMat, noErrorBars = F)\n@\n\\end{center}\nGet LODR annotations for adding to plots and then annotate the dynamic range plot with LODR estimate information.\n<<fig=T>>=\nLODR.annot.ERCC <- printLODRres(expDat, dynRangeDat,\n                                lodr.res = lodr.ERCC)\ndynRangePlotLODR(dynRangeRes = dynRangeDat$dynRangePlotRes,\n                 LODR.annot.ERCC = LODR.annot.ERCC)\n@\nGenerate MA plots of erccs coded by concentrations from LODR\n\n<<fig=T>>=\nmaPlotAB = maConcPlot(expDat, LODR.annot.ERCC, alphaPoint = 0.8, r_mAdjust = T, \n                      replicate = T)\n@\n\nIf you wish, save your results to an Rdata file that can be reused.\nsaveResults(expDat, erccROC.res, maPlotAB, lodr.ERCC)\n\n\n\n\\end{document}",
    "created" : 1383959724328.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3182661994",
    "id" : "77E6007C",
    "lastKnownWriteTime" : 1383971433,
    "path" : "~/Documents/NISTMunro/Projects/testerccdashboard/inst/doc/erccdashboardVignetteTry2.Rnw",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}